# Test stacktool functions.
I common.mc
L stacktool.ld
:Stack1 0
:Stack2 0
:Stack1Store 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
:Stack2Store
0 0 0 0 0 0 0 0
M DSTACK :%0Here @PRT "<" @PRTREF %0Here @PRT ">" @StackDump
:Main . Main
#@DSTACK
@PUSH 15
@PUSH Stack1Store
@CALL ST_INIT
@POPI Stack1
#@DSTACK
@PUSH 3
@PUSH Stack2Store
@CALL ST_INIT
@POPI Stack2
#@DSTACK
#
@CALL Load1
#
@PRTLN "TOP"
#@DSTACK
@PUSHI Stack1 @CALL ST_TOP @PRTTOP @POPNULL @PRTNL
#@DSTACK
@PRTLN "POPs"
@PUSHI Stack1 @CALL ST_POP @PRTTOP @POPNULL @PRTNL
@PUSHI Stack1 @CALL ST_POP @PRTTOP @POPNULL @PRTNL
@PUSHI Stack1 @CALL ST_POP @PRTTOP @POPNULL @PRTNL
#
#@DSTACK
@CALL Load1

@PRTLN "SWP"
@PUSHI Stack1 @CALL ST_SWP
@PUSHI Stack1 @CALL ST_TOP @PRTTOP @POPNULL @PRTNL
@PUSHI Stack1 @CALL ST_SWP
@PUSHI Stack1 @CALL ST_TOP @PRTTOP @POPNULL @PRTNL

#
@PRTLN "NTH 3 - 1 - 2"
@PUSHI Stack1 @PUSH 2 @CALL ST_NTH @PRTTOP @POPNULL @PRTNL
@PUSHI Stack1 @PUSH 0 @CALL ST_NTH @PRTTOP @POPNULL @PRTNL
@PUSHI Stack1 @PUSH 1 @CALL ST_NTH @PRTTOP @POPNULL @PRTNL
#
@PRTLN "SIZEOF"
#@DSTACK
@PUSHI Stack1 @CALL ST_SIZEOF @PRTTOP @POPNULL @PRTNL
#@DSTACK
@END


:Load1
@PUSHI Stack1 @PUSH 0x10 @CALL ST_PUSH
@PUSHI Stack1 @PUSH 0x20 @CALL ST_PUSH
@PUSHI Stack1 @PUSH 0x30 @CALL ST_PUSH
@RET
